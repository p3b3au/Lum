<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="log.js" type="text/javascript"></script>
    <script src="timer.js" type="text/javascript"></script>
    <title>LuMax</title>

</head>

<body>
    <h2>Atteins la vitesse de la Lumière</h2>
    <div class=playableButtons><strong>Augmente ta vitesse</strong><br>
        <button class=btnV value="10" id="vAdd1"><abbr title="10 m$">+1</abbr></button>

        <button class=btnV value="100" id="vAdd2"><abbr title="100 m$">+10</abbr></button>
        <button class=btnV id="vAdd3"><abbr title="1 000 m$">+100</abbr></button>
        <button class=btnV id="vAdd4"><abbr title="1e4 m$">+1000</abbr></button>
    </div>
    <br>
    <div class=playableButtons><strong>Augmente ton accélération</strong><br>
        <button class=btnA id="aAdd1"><abbr title="1e4 m$">+1</abbr></button>
        <button class=btnA id="aAdd2"><abbr title="1e5 m$">+10</abbr></button>
        <button class=btnA id="aAdd3"><abbr title="1e6 m$">+100</abbr></button>
        <button class=btnA id="aAdd4"><abbr title="1e7 m$">+1000</abbr></button>
    </div>
    <br>
    <div class=playableButtons><strong>Accélère ton accélération</strong><br>
        <button class=btnX id="xAdd1"><abbr title="1e7 m$">+1</abbr></button>
        <button class=btnX id="xAdd2"><abbr title="1e8 m$">+10</abbr></button>
        <button class=btnX id="xAdd3"><abbr title="1e9 m$">+100</abbr></button>
        <button class=btnX id="xAdd4"><abbr title="1e10 m$">+1000</abbr></button>
    </div>

    <hr>
    <div class=counters>
        <div class=displayNb id="V">Vitesse : 1 m/s;</div>
        <div class=displayNb id="A">Accélération : 0 m/s²</div>
        <div class=displayNb id="X">Sur Accélération : 0 m/s³</div>
        <div class=displayNb id="G"></div>
        <div class=displayNb id="M">M</div>
        <div class=displayNb id="Tps">temps restant</div> <progress id=progressbar value="" max="100">{{CC}}%</progress>
        <br>
        <div class=displayNb id="D"></div>
        <div class=displayNb id="C">% célérité</div>
    </div>

    <hr>
    <div class="event-log">
        <label></label>
        <textarea readonly id="log-contents" rows="8" cols="30"></textarea>
    </div>
    <br>
    <div class=event id="T"></div><br>

    </div>
</body>

<script>
    const param = 1000; // fréquence de rafraichissement en ms


    var D = 0; // Distance totale affichée
    var V = 1; // Vitesse affichée
    var A = 0; // Accérélarion affichée
    var M = 0; // Money affichée (D-coût des boutons)
    var X = 0; // Accélération² affichée

    const divD = document.getElementById("D");
    const divV = document.getElementById("V");
    const divM = document.getElementById("M");
    const divA = document.getElementById("A");
    const divC = document.getElementById("C");
    const divX = document.getElementById("X");
    const divG = document.getElementById("G");
    const divTps = document.getElementById("Tps");


    const vAdd1 = document.getElementById("vAdd1");
    const vAdd2 = document.getElementById("vAdd2");
    const vAdd3 = document.getElementById("vAdd3");
    const vAdd4 = document.getElementById("vAdd4");
    const aAdd1 = document.getElementById("aAdd1");
    const aAdd2 = document.getElementById("aAdd2");
    const aAdd3 = document.getElementById("aAdd3");
    const aAdd4 = document.getElementById("aAdd4");
    const xAdd1 = document.getElementById("xAdd1");
    const xAdd2 = document.getElementById("xAdd2");
    const xAdd3 = document.getElementById("xAdd3");
    const xAdd4 = document.getElementById("xAdd4");

    const log = document.getElementById("log-contents");
    const time1 = document.getElementById("T");


    timer();

    let Va = 0;
    let Vb = 0;
    let CC = 0;
    
    


    // les valeurs variables //

    function showVariables() {
        V = V + A;
        A = A + X;
        M = M + V;
        D = D + V;
        C = V / 3e8;
        G = A / 9.8;
        K = V * 3.6;
        AL = D / 9.46e15;
        Vb = Va;
        Va = V;

        CC = C*100;
                  
       zz = ((3e8-Va)/((Va-Vb)))
     zzz = ((V+A+X/2) - Math.sqrt((V+A+X/2)*(V+A+X/2) + 2*3e8*X))/-X

        showALL();
        checkBut();
        displayProgress()
        console.log(Va-Vb, A)
          };

    function showALL() {
        showA();
        showC();
        showD();
        showG();
        showM();
        showV();
        showX();
        showTps();
        showTime();
        checkBut();
        logTest();
    }

    function numberWithSpace(x) {
        if (x > 1000) {
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ')
        } else {
            return x
        }
    };

    function displayProgress(){
       let prog = document.getElementById('progressbar');
       prog.setAttribute("value", `${CC}`);
    };

    ///////////// FONCTIONS D'AFFICHAGE //////////////
    function showA() {
        var AA = numberWithSpace(A);
        divA.innerHTML = `Accélération : ${AA} m/s²`
    };

    function showTps() {
        let years = (zz/31536000);
        let months = ((zz%31536000)/2629800);
        let days = (((zz%31536000)%2629800)/86400);
        let hours = ((((zz%31536000)%2629800)%86400)/3600);
        let minutes = (((((zz%31536000)%2629800)%86400)%3600)/60);
        let seconds = (((((zz%31536000)%2629800)%86400)%3600)%60);
        let yearsZ = (zzz/31536000);
        let monthsZ = ((zzz%31536000)/2629800);
        let daysZ = (((zzz%31536000)%2629800)/86400);
        let hoursZ = ((((zzz%31536000)%2629800)%86400)/3600);
        let minutesZ = (((((zzz%31536000)%2629800)%86400)%3600)/60);
        let secondsZ = (((((zzz%31536000)%2629800)%86400)%3600)%60);
        var Tps = numberWithSpace(zz);
        divTps.innerHTML = `Temps restant : ${Tps} s <br> ${Math.floor(years)} années, ${Math.floor(months)} mois, ${Math.floor(days)} jours, ${Math.floor(hours)} heures, ${Math.floor(minutes)} minutes, ${Math.floor(seconds)} secondes <br> ${Math.floor(yearsZ)} années, ${Math.floor(monthsZ)} mois, ${Math.floor(daysZ)} jours, ${Math.floor(hoursZ)} heures, ${Math.floor(minutesZ)} minutes, ${Math.floor(secondsZ)} secondes`;
        
    };

    function showC() {
        let CC = numberWithSpace(C);
        let KK = '';
        if (K < 1000) {
            KK = K.toFixed(2)
        } else {
            KK = numberWithSpace(K.toFixed(0))
        }
        divC.innerHTML = `Vitesse : ${CC} c <br>-->   ${KK} km/h`;
    };

    function showD() {
        let DD = numberWithSpace(D);
        let AAL = numberWithSpace(AL);
        if (D < 1e9) {
            divD.innerHTML = `Distance totale parcourue : ${DD} m  <br>--> ${AAL} AL`;
        } else {
            let Dkm = D / 1000;
            let DDkm = numberWithSpace(Dkm.toFixed(0));
            divD.innerHTML = `Distance totale parcourue : ${DDkm} km  <br>--> ${AAL} AL`;
        }
    };

    function showG() {
        let GG = G;
        if (G > 1) {
            GG = G.toFixed(2)
        }
        if (G > 1000) {
            GG = numberWithSpace(G.toFixed(0))
        }
        divG.innerHTML = `--> ${GG} G`
    };

    function showM() {
        let MM = numberWithSpace(M);
        divM.innerHTML = `Money : ${MM} m$`
    };

    function showV() {
        let VV = numberWithSpace(V);
        divV.innerHTML = `Vitesse : ${VV} m/s`
    };

    function showX() {
        let XX = numberWithSpace(X);
        divX.innerHTML = `Sur Accélération : ${XX} m/s³`
    };



    /////////////////////// LOG //////////////////////

    const logInfo = [
        ['d', 3, 'Distance 3'],
        ['d', 10000, 'Tu as traversé Lyon'],
        ['d', 10, 'Distance 10'],
        ['d', 20, 'Distance 20'],
        ['v', 10, 'vitesse 10'],
        ['v', 20, 'vitesse 20'],
        ['m', 100, 'money 100'],
        ['m', 1000, 'money 1000'],
        ['m', 10000, 'money 10 000'],
        ['m', 100000, 'money 100 000'],
        ['m', 1000000, 'money 1 000 000'],
        ['m', 10000000, 'money 10 000 000'],
        ['m', 100000000, 'money 100 000 000'],
        ['m', 1000000000, 'money 1 000 000 000'],
        ['a', 1, 'accelere !!!'],
        ['a', 10, '1G !!'],
        ['a', 1000, 'et 100G dans ta mouille, et tu es de la bouillie'],
        ['a', 10000, '1000G !? Mieux vaut être cryogénisé, enfin pas sûr...'],
        ['a', 100000, '10 000G !? euh...'],
        ['v', 300000000, 'vitesse de la lumiere'],
        ['d', 384400000, 'Distance Terre - Lune'],
        ['d', 16500000, 'Tu as traversé le Pacifique'],
        ['d', 149597870700, 'Distance Terre - Soleil'],
        ['v', 340, 'MACH 1'],
        ['v', 680, 'MACH 2'],
        ['v', 1020, 'MACH 3'],
        ['v', 3400, 'MACH 10'],
        ['v', 34000, 'MACH 100'],
        ['v', 340000, 'MACH 1000'],
        ['v', 3400000, 'MACH 10 000'],
        ['v', 34000000, 'MACH 100 000'],
        ['v', 340000000, 'MACH 1 000 000'],

    ];

    function logTest() {
        for (i = 0; i < logInfo.length; i++) {
            let i0 = logInfo[i][0]
            let i1 = logInfo[i][1]
            let i3 = logInfo[i][2]
            if (i0 == 'd') {
                if (D > i1) {
                    log.textContent = `${i3}\n` + log.textContent;
                    logInfo.splice(i, 1);
                }
            }
            if (i0 == 'v') {
                if (V > i1) {
                    log.textContent = `${i3}\n` + log.textContent;
                    logInfo.splice(i, 1);
                }
            }
            if (i0 == 'a') {
                if (A > i1) {
                    log.textContent = `${i3}\n` + log.textContent;
                    logInfo.splice(i, 1);
                }
            }
            if (i0 == 'm') {
                if (M > i1) {
                    log.textContent = `${i3}\n` + log.textContent;
                    logInfo.splice(i, 1);
                }
            }
        }


        if (V > 300000000) {
            alert(`tu as gagné !!!!!!!!!!!!!!! \n en ${showTime()}`);
            storeScore()
        }
    }

    //// LOG END /////////////////////////////


    /////////////////// timer ////////////////////
    function timer() {
        window.onload = storeTime
    };


    function storeTime() {
        let T0 = Date.now();
        localStorage.setItem('tTime', T0);
        console.log('Temps stocké')
    };

    function storeScore() {
        let tEnd = Date.now();
        localStorage.setItem('End', tEnd);
        console.log('Score stocké')
    };


    function showTime() {
        if (localStorage.getItem('tTime')) {
            T0 = localStorage.getItem('tTime')
            let now = Date.now();
            let TT = (now - T0) / 60000;
            var TTT = numberWithSpace(TT.toFixed(0))
            var sec = (((now - T0) - (now - T0) / 60000) / 1000) % 60;
            var Ssec = sec.toFixed(0)
            return `${TTT} minutes et ${Ssec} secondes`;
        } else {
            return 'on a perdu ton temps ...';
        }
    }
    /////////////////////////// timer end ///////////////










    // fonction des boutons //
    const x = 10;

    function vBtnCalc(e) {
        if (M > e) {
            V = V + e * 10; ///////////// pas * remettre /                  -----------------------------
            M = M - e;
            showALL();
        }
    };

    function aBtnCalc(e) {
        if (M > e) {
            A = A + e / 1e2; //////////// remetre e4
            M = M - e;
            showALL();;
        }
    };

    function xBtnCalc(e) {
        if (M > e) {
            X = X + e / 1e5;  //////// remettre e7
            M = M - e;
            showALL();
        }
    };


    // On click

    vAdd1.onclick = function () {
        vBtnCalc(x)
    };
    vAdd2.onclick = function () {
        vBtnCalc(Math.pow(x, 2))
    };
    vAdd3.onclick = function () {
        vBtnCalc(Math.pow(x, 3))
    };
    vAdd4.onclick = function () {
        vBtnCalc(Math.pow(x, 4))
    };

    aAdd1.onclick = function () {
        aBtnCalc(Math.pow(x, 4))
    };
    aAdd2.onclick = function () {
        aBtnCalc(Math.pow(x, 5))
    };
    aAdd3.onclick = function () {
        aBtnCalc(Math.pow(x, 6))
    };
    aAdd4.onclick = function () {
        aBtnCalc(Math.pow(x, 7))
    };

    xAdd1.onclick = function () {
        xBtnCalc(Math.pow(x, 7))
    };
    xAdd2.onclick = function () {
        xBtnCalc(Math.pow(x, 8))
    };
    xAdd3.onclick = function () {
        xBtnCalc(Math.pow(x, 9))
    };
    xAdd4.onclick = function () {
        xBtnCalc(Math.pow(x, 10))
    };


    // able des bouttons // 

    function checkBut() {
        vAdd1.disabled = true;
        vAdd2.disabled = true;
        vAdd3.disabled = true;
        vAdd4.disabled = true;
        aAdd1.disabled = true;
        aAdd2.disabled = true;
        aAdd3.disabled = true;
        aAdd4.disabled = true;
        xAdd1.disabled = true;
        xAdd2.disabled = true;
        xAdd3.disabled = true;
        xAdd4.disabled = true;

        if (M >= 10) {
            vAdd1.disabled = false;
        };
        if (M >= 100) {
            vAdd2.disabled = false;
        };
        if (M >= 1000) {
            vAdd3.disabled = false;
        }
        if (M >= 1e4) {
            vAdd4.disabled = false;
        }
        if (M >= 1e4) {
            aAdd1.disabled = false;
        }
        if (M >= 1e5) {
            aAdd2.disabled = false;
        }
        if (M >= 1e6) {
            aAdd3.disabled = false;
        }
        if (M >= 1e7) {
            aAdd4.disabled = false;
        }
        if (M >= 1e7) {
            xAdd1.disabled = false;
        }
        if (M >= 1e8) {
            xAdd2.disabled = false;
        }
        if (M >= 1e9) {
            xAdd3.disabled = false;
        }
        if (M >= 1e10) {
            xAdd4.disabled = false;
        }
    };






    // temps de la seconde ! //
    // setInterval(checkBut, param);
    setInterval(showVariables, param);
    ///////////////////////////////
</script>

</html>
<style>
:root{--color1:#37916e;
    --color2:#5c2f05;
    --color3: rgb(0, 0, 0, 0.5)
}

    .counters {
        display: flexbox;
    }

    .playableButtons {
        display: flexbox;
    }

    #event {
        font-family: bold;
        align-content: center;
    }

    abbr {
        border-bottom: none !important;
        cursor: inherit !important;
        text-decoration: none !important;
    }

    h2 {
        font-family: bold;
    }



    #progressbar{
  width: 1000px;
  padding:0px;
  border:1px solid black;
  border-radius: 12px;
  height:12px;
  }

#progressbar[value]{
    background: var(--color2);
    }

#progressbar::-webkit-progress-bar {
    border-radius: 12px;
    background: var(--color2);
}
#progressbar::-webkit-progress-value {
	background: var(--color1);
    /*
    animation: toto 1000ms ease;*/
    width: 200px;
}
#progressbar::-moz-progress-bar {
	background: var(--color1);
    /*
    animation: toto 1000ms ease;*/
    width: 200px;
}

</style>